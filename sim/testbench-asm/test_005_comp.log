
Picoblaze Assembler based on kpicosim  Version 1.0
Source File: /home/semai/Work/REPO_HOME/asylum/OpenBlaze8/tools/../sim/testbench-asm/test_005_comp.psm

Line  Addr Instr  Source Code
   1              ; ;------------------------------------
   2              ; ; Test 005
   3              ; ; Compare (use register) + Jump condionnel (Z,NZ,C,NC)
   4              ; ;------------------------------------
   5              
   6              ; ;------------------------------------
   7              ; ; directive compilation fichier
   8              ; ;------------------------------------
   9              
  10              VHDL      "../ROM_blank_adh.vhd", "../../OpenBlaze8_ROM.vhd", "OpenBlaze8_ROM"
  11              
  12              ; ;------------------------------------
  13              ; ; Constantes
  14              ; ;------------------------------------
  15              sp                  EQU       sF
  16              
  17              test_val_ok         EQU       $FA
  18              test_val_ko         EQU       $ED
  19              
  20              ; ;------------------------------------
  21              ; ; directives pour le simulateur:  definition des  E/S
  22              ; ;------------------------------------
  23              switch_id           EQU       $00
  24              led_id              EQU       $20
  25              debug_id            EQU       $e0
  26              
  27              switch              DSIN      switch_id
  28              led                 DSOUT     led_id
  29              debug               DSOUT     debug_id
  30              
  31              ; ;------------------------------------
  32              ; ; MAIN
  33              ; ;------------------------------------
  34                                  ORG       $000
  35              main: 
  36              
  37              test_nz: 
  38  000  00321                      LOAD      s3, $21
  39  001  00448                      LOAD      s4, $48
  40  002  00512                      LOAD      s5, $12
  41  003  00648                      LOAD      s6, $48
  42  004  00718                      LOAD      s7, $18
  43  005  00858                      LOAD      s8, $58
  44  006  00921                      LOAD      s9, $21
  45  007  15350                      COMP      s3, s5
  46  008  3540a                      JUMP      NZ, test_nz_ok
  47  009  34015                      JUMP      test_ko
  48              
  49              test_nz_ok: 
  50  00a  15460                      COMP      s4, s6
  51  00b  3500d                      JUMP      Z, test_z_ok
  52  00c  34015                      JUMP      test_ko
  53              
  54              test_z_ok: 
  55  00d  15370                      COMP      s3, s7
  56  00e  35c10                      JUMP      NC, test_nc_ok
  57  00f  34015                      JUMP      test_ko
  58              
  59              test_nc_ok: 
  60  010  15480                      COMP      s4, s8
  61  011  35813                      JUMP      C, test_c_ok
  62  012  34015                      JUMP      test_ko
  63              
  64              
  65              test_c_ok: 
  66  013  15390                      COMP      s3, s9
  67  014  35ffc                      JUMP      NC, test_ok
  68              
  69              ; ;------------------------------------
  70              ; ; Test ok/ko
  71              ; ;------------------------------------
  72              test_ko:
  73  015  00eed                      LOAD      sE, test_val_ko
  74  016  2cee0                      OUT       sE, debug_id
  75  017  34015                      JUMP      test_ko
  76              
  77                                  ORG       $3FC
  78              test_ok: 
  79                                  LOAD      sE, test_val_ok
  80                                  OUT       sE, debug_id
  81                                  JUMP      test_ok
  82              
  83              ; ;------------------------------------
  84              ; ; Interrupt VECTOR
  85              ; ;------------------------------------
  86                                  ORG       $3FF
  87                                  RETI      ENABLE
