
Picoblaze Assembler based on kpicosim  Version 1.0
Source File: /home/semai/Work/REPO_HOME/asylum/OpenBlaze8/tools/../sim/testbench-asm/test_038_in_out.psm

Line  Addr Instr  Source Code
   1              ; ;------------------------------------
   2              ; ; Test 038
   3              ; ; Sequence of 255 Out/In
   4              ; ; Warning !!!
   5              ; ; In testbench HDL, switch = ~led
   6              ; ; In simulation, set manually switch value
   7              ; ;------------------------------------
   8              
   9              ; ;------------------------------------
  10              ; ; directive compilation fichier
  11              ; ;------------------------------------
  12              
  13                                  VHDL      "../ROM_blank_adh.vhd", "../../OpenBlaze8_ROM.vhd", "OpenBlaze8_ROM"
  14              
  15              ; ;------------------------------------
  16              ; ; Constantes
  17              ; ;------------------------------------
  18              sp                  EQU       sF
  19              
  20              test_val_ok         EQU       $FA
  21              test_val_ko         EQU       $ED
  22              
  23              ; ;------------------------------------
  24              ; ; directives pour le simulateur:  definition des  E/S
  25              ; ;------------------------------------
  26              switch_id           EQU       $00
  27              led_id              EQU       $20
  28              debug_id            EQU       $E0
  29              
  30              switch              DSIN      switch_id
  31              led                 DSOUT     led_id
  32              debug               DSOUT     debug_id
  33              
  34              ; ;------------------------------------
  35              ; ; MAIN
  36              ; ;------------------------------------
  37                                  ORG       $00
  38              main: 
  39  000  000ff                      LOAD      s0, $FF
  40              main_loop: 
  41  001  2c020                      OUT       s0, led_id
  42  002  04100                      IN        s1, switch_id
  43  003  01200                      LOAD      s2, s0
  44  004  0e2ff                      XOR       s2, $FF
  45  005  15120                      COMP      s1, s2
  46  006  3540a                      JUMP      NZ, test_ko
  47  007  1c001                      SUB       s0, $1
  48  008  35c01                      JUMP      NC, main_loop
  49  009  343fc                      JUMP      test_ok
  50              ; ;------------------------------------
  51              ; ; Test ok/ko
  52              ; ;------------------------------------
  53              test_ko: 
  54  00a  00eed                      LOAD      sE, test_val_ko
  55  00b  2cee0                      OUT       sE, debug_id
  56  00c  3400a                      JUMP      test_ko
  57              
  58                                  ORG       $3FC
  59              test_ok: 
  60                                  LOAD      sE, test_val_ok
  61                                  OUT       sE, debug_id
  62                                  JUMP      test_ok
  63              
  64              ; ;------------------------------------
  65              ; ; Interrupt VECTOR
  66              ; ;------------------------------------
  67                                  ORG       $3FF
  68                                  RETI      ENABLE
