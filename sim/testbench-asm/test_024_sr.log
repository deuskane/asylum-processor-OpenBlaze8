
Picoblaze Assembler based on kpicosim  Version 1.0
Source File: /home/semai/Work/REPO_HOME/asylum/OpenBlaze8/tools/../sim/testbench-asm/test_024_sr.psm

Line  Addr Instr  Source Code
   1              ; ;------------------------------------
   2              ; ; Test 021
   3              ; ; All shift right
   4              ; ;------------------------------------
   5              
   6              ; ;------------------------------------
   7              ; ; directive compilation fichier
   8              ; ;------------------------------------
   9              
  10              VHDL      "../ROM_blank_adh.vhd", "../../OpenBlaze8_ROM.vhd", "OpenBlaze8_ROM"
  11              
  12              ; ;------------------------------------
  13              ; ; Constantes
  14              ; ;------------------------------------
  15              sp                  EQU       sF
  16              
  17              test_val_ok         EQU       $FA
  18              test_val_ko         EQU       $ED
  19              
  20              ; ;------------------------------------
  21              ; ; directives pour le simulateur:  definition des  E/S
  22              ; ;------------------------------------
  23              switch_id           EQU       $00
  24              led_id              EQU       $20
  25              debug_id            EQU       $e0
  26              
  27              switch              DSIN      switch_id
  28              led                 DSOUT     led_id
  29              debug               DSOUT     debug_id
  30              
  31              ; ;------------------------------------
  32              ; ; MAIN
  33              ; ;------------------------------------
  34                                  ORG       $000
  35              main: 
  36  000  000a5                      LOAD      s0, $A5
  37  001  0015a                      LOAD      s1, $5A
  38  002  00200                      LOAD      s2, $00
  39  003  00304                      LOAD      s3, $04
  40  004  00421                      LOAD      s4, $21
  41              
  42              ; sr0
  43  005  01900                      LOAD      s9, s0
  44              
  45  006  2090e                      SR0       s9                  ; 10100101 -> 01010010
  46  007  35c9c                      JUMP      NC, test_ko
  47  008  3509c                      JUMP      Z, test_ko
  48              
  49  009  14952                      COMP      s9, $52
  50  00a  3589c                      JUMP      C, test_ko
  51  00b  3549c                      JUMP      NZ, test_ko
  52              
  53              
  54  00c  2090e                      SR0       s9                  ; 01010010 -> 00101001
  55  00d  3589c                      JUMP      C, test_ko
  56  00e  3509c                      JUMP      Z, test_ko
  57              
  58  00f  14929                      COMP      s9, $29
  59  010  3589c                      JUMP      C, test_ko
  60  011  3549c                      JUMP      NZ, test_ko
  61              
  62  012  2090e                      SR0       s9                  ; 00101001 -> 00010100
  63  013  2090e                      SR0       s9                  ; 00010100 -> 00001010
  64  014  2090e                      SR0       s9                  ; 00001010 -> 00000101
  65  015  2090e                      SR0       s9                  ; 00000101 -> 00000010
  66  016  2090e                      SR0       s9                  ; 00000010 -> 00000001
  67  017  3589c                      JUMP      C, test_ko
  68  018  3509c                      JUMP      Z, test_ko
  69              
  70  019  14901                      COMP      s9, $01
  71  01a  3589c                      JUMP      C, test_ko
  72  01b  3549c                      JUMP      NZ, test_ko
  73              
  74  01c  2090e                      SR0       s9                  ; 00000001 -> 00000000
  75  01d  35c9c                      JUMP      NC, test_ko
  76  01e  3549c                      JUMP      NZ, test_ko
  77              
  78  01f  14900                      COMP      s9, $00
  79  020  3589c                      JUMP      C, test_ko
  80  021  3549c                      JUMP      NZ, test_ko
  81              
  82              
  83              ; sr1
  84  022  01900                      LOAD      s9, s0
  85              
  86  023  2090f                      SR1       s9                  ; 10100101 -> 11010010
  87  024  35c9c                      JUMP      NC, test_ko
  88  025  3509c                      JUMP      Z, test_ko
  89              
  90  026  149d2                      COMP      s9, $D2
  91  027  3589c                      JUMP      C, test_ko
  92  028  3549c                      JUMP      NZ, test_ko
  93              
  94              
  95  029  2090f                      SR1       s9                  ; 11010010 -> 11101001
  96  02a  3589c                      JUMP      C, test_ko
  97  02b  3509c                      JUMP      Z, test_ko
  98              
  99  02c  149e9                      COMP      s9, $E9
 100  02d  3589c                      JUMP      C, test_ko
 101  02e  3549c                      JUMP      NZ, test_ko
 102              
 103  02f  2090f                      SR1       s9                  ; 11101001 -> 11110100
 104  030  2090f                      SR1       s9                  ; 11110100 -> 11111010
 105  031  2090f                      SR1       s9                  ; 11111010 -> 11111101
 106  032  2090f                      SR1       s9                  ; 11111101 -> 11111110
 107  033  35c9c                      JUMP      NC, test_ko
 108  034  3509c                      JUMP      Z, test_ko
 109              
 110  035  149fe                      COMP      s9, $FE
 111  036  3589c                      JUMP      C, test_ko
 112  037  3549c                      JUMP      NZ, test_ko
 113              
 114  038  2090f                      SR1       s9                  ; 11111110 -> 11111111
 115  039  3589c                      JUMP      C, test_ko
 116  03a  3509c                      JUMP      Z, test_ko
 117              
 118  03b  149ff                      COMP      s9, $FF
 119  03c  3589c                      JUMP      C, test_ko
 120  03d  3549c                      JUMP      NZ, test_ko
 121              
 122              ; sla
 123  03e  01900                      LOAD      s9, s0
 124              
 125  03f  15340                      COMP      s3, s4              ; set carry
 126  040  20908                      SRA       s9                  ; 10100101 -> 11010010
 127  041  35c9c                      JUMP      NC, test_ko
 128  042  3509c                      JUMP      Z, test_ko
 129              
 130  043  149d2                      COMP      s9, $D2
 131  044  3589c                      JUMP      C, test_ko
 132  045  3549c                      JUMP      NZ, test_ko
 133              
 134              
 135  046  15340                      COMP      s3, s4              ; set carry
 136  047  20908                      SRA       s9                  ; 11010010 -> 11101001
 137  048  3589c                      JUMP      C, test_ko
 138  049  3509c                      JUMP      Z, test_ko
 139              
 140  04a  149e9                      COMP      s9, $E9
 141  04b  3589c                      JUMP      C, test_ko
 142  04c  3549c                      JUMP      NZ, test_ko
 143              
 144  04d  01900                      LOAD      s9, s0
 145              
 146  04e  15430                      COMP      s4, s3              ; unset carry
 147  04f  20908                      SRA       s9                  ; 10100101 -> 01010010
 148  050  35c9c                      JUMP      NC, test_ko
 149  051  3509c                      JUMP      Z, test_ko
 150              
 151  052  14952                      COMP      s9, $52
 152  053  3589c                      JUMP      C, test_ko
 153  054  3549c                      JUMP      NZ, test_ko
 154              
 155              
 156  055  15430                      COMP      s4, s3              ; unset carry
 157  056  20908                      SRA       s9                  ; 01010010 -> 00101001
 158  057  3589c                      JUMP      C, test_ko
 159  058  3509c                      JUMP      Z, test_ko
 160              
 161  059  14929                      COMP      s9, $29
 162  05a  3589c                      JUMP      C, test_ko
 163  05b  3549c                      JUMP      NZ, test_ko
 164              
 165              
 166  05c  15430                      COMP      s4, s3              ; unset carry
 167  05d  20908                      SRA       s9                  ; 00101001 -> 00010100
 168  05e  15430                      COMP      s4, s3              ; unset carry
 169  05f  20908                      SRA       s9                  ; 00010100 -> 00001010
 170  060  15430                      COMP      s4, s3              ; unset carry
 171  061  20908                      SRA       s9                  ; 00001010 -> 00000101
 172  062  15430                      COMP      s4, s3              ; unset carry
 173  063  20908                      SRA       s9                  ; 00000101 -> 00000010
 174  064  15430                      COMP      s4, s3              ; unset carry
 175  065  20908                      SRA       s9                  ; 00000010 -> 00000001
 176  066  3589c                      JUMP      C, test_ko
 177  067  3509c                      JUMP      Z, test_ko
 178              
 179  068  14901                      COMP      s9, $01
 180  069  3589c                      JUMP      C, test_ko
 181  06a  3549c                      JUMP      NZ, test_ko
 182              
 183  06b  15430                      COMP      s4, s3              ; unset carry
 184  06c  20908                      SRA       s9                  ; 00000001 -> 00000000
 185  06d  35c9c                      JUMP      NC, test_ko
 186  06e  3549c                      JUMP      NZ, test_ko
 187              
 188  06f  14900                      COMP      s9, $00
 189  070  3589c                      JUMP      C, test_ko
 190  071  3549c                      JUMP      NZ, test_ko
 191              
 192              ; srx
 193  072  01900                      LOAD      s9, s0
 194              
 195  073  2090a                      SRX       s9                  ; 10100101 -> 11010010
 196  074  35c9c                      JUMP      NC, test_ko
 197  075  3509c                      JUMP      Z, test_ko
 198              
 199  076  149d2                      COMP      s9, $D2
 200  077  3589c                      JUMP      C, test_ko
 201  078  3549c                      JUMP      NZ, test_ko
 202              
 203              
 204  079  2090a                      SRX       s9                  ; 11010010 -> 11101001
 205  07a  3589c                      JUMP      C, test_ko
 206  07b  3509c                      JUMP      Z, test_ko
 207              
 208  07c  149e9                      COMP      s9, $E9
 209  07d  3589c                      JUMP      C, test_ko
 210  07e  3549c                      JUMP      NZ, test_ko
 211              
 212  07f  01910                      LOAD      s9, s1
 213              
 214  080  2090a                      SRX       s9                  ; 01011010 -> 00101101
 215  081  3589c                      JUMP      C, test_ko
 216  082  3509c                      JUMP      Z, test_ko
 217              
 218  083  1492d                      COMP      s9, $2D
 219  084  3589c                      JUMP      C, test_ko
 220  085  3549c                      JUMP      NZ, test_ko
 221              
 222              
 223  086  2090a                      SRX       s9                  ; 00101101 -> 00010110
 224  087  35c9c                      JUMP      NC, test_ko
 225  088  3509c                      JUMP      Z, test_ko
 226              
 227  089  14916                      COMP      s9, $16
 228  08a  3589c                      JUMP      C, test_ko
 229  08b  3549c                      JUMP      NZ, test_ko
 230              
 231  08c  2090a                      SRX       s9                  ; 00010110 -> 00001011
 232  08d  2090a                      SRX       s9                  ; 00001011 -> 00000101
 233  08e  2090a                      SRX       s9                  ; 00000101 -> 00000010
 234  08f  2090a                      SRX       s9                  ; 00000010 -> 00000001
 235  090  3589c                      JUMP      C, test_ko
 236  091  3509c                      JUMP      Z, test_ko
 237              
 238  092  14901                      COMP      s9, $01
 239  093  3589c                      JUMP      C, test_ko
 240  094  3549c                      JUMP      NZ, test_ko
 241              
 242  095  2090a                      SRX       s9                  ; 00000001 -> 00000000
 243  096  35c9c                      JUMP      NC, test_ko
 244  097  3549c                      JUMP      NZ, test_ko
 245              
 246  098  14900                      COMP      s9, $00
 247  099  3589c                      JUMP      C, test_ko
 248  09a  3549c                      JUMP      NZ, test_ko
 249              
 250  09b  343fc                      JUMP      test_ok
 251              
 252              ; ;------------------------------------
 253              ; ; Test ok/ko
 254              ; ;------------------------------------
 255              test_ko:
 256  09c  00eed                      LOAD      sE, test_val_ko
 257  09d  2cee0                      OUT       sE, debug_id
 258  09e  3409c                      JUMP      test_ko
 259              
 260                                  ORG       $3FC
 261              test_ok: 
 262                                  LOAD      sE, test_val_ok
 263                                  OUT       sE, debug_id
 264                                  JUMP      test_ok
 265              
 266              ; ;------------------------------------
 267              ; ; Interrupt VECTOR
 268              ; ;------------------------------------
 269                                  ORG       $3FF
 270                                  RETI      ENABLE
